module @control_flow;

const @test_failure = "test failure", 0;

function @assert_eq(2 => 0) {
    $scmp;
    global_addr @test_failure; panic_if cmp_ne;
    return;
}

function @test_jump(0 => 0) {
    int 0;
    jump %next;
label %next(1):
    int 1;
    jump %last;
label %last(2):
    int 2;

    int 2; call @assert_eq;
    int 1; call @assert_eq;
    int 0; call @assert_eq;
    return;
}

function @test_branch_is_false(0 => 0) {
    int 0;
    jump_if is_false %okay;
    jump %error;

label %okay:
    return;

label %error:
    global_addr @test_failure; panic;
    return;
}
function @test_branch_is_true(0 => 0) {
    int 1;
    jump_if is_true %okay;
    jump %error;
label %okay:
    return;
label %error:
    global_addr @test_failure; panic;
    return;
}
